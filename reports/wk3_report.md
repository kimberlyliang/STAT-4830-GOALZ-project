INTRODUCTION
Sleep staging from electroencephalography (EEG) data is critical not only for diagnosing sleep disorders but also for advancing our understanding of circadian rhythms and for the development of wearable sleep tracking devices. Manual polysomnographic (PSG) evaluations remain the gold standard; however, they require monitoring multiple physiological parameters (EEG, electrooculography, electromyography, electrocardiography, and respiratory sensors) and involve labor‐intensive annotation. Automated algorithms have been proposed to alleviate these challenges; yet, they frequently depend on predefined or assumed in-bed intervals. Such methods often yield high sensitivity for sleep epochs at the expense of low specificity for wake epochs, thereby underestimating wake time—a particularly problematic issue for individuals with low sleep efficiency. In this project, we focus on optimizing sleep stage classification with an emphasis on detecting sleep onset and discriminating between wakefulness and sleep across both daytime and nighttime patterns. In doing so, our aim is not only to enhance classification performance but also to potentially reveal biomarkers that could offer insights into the neurophysiology of sleep transitions for healthy subjects as well as individuals suffering from clinical conditions causing sleep impairment.

PROBLEM DESCRIPTION
Our project intends to optimize the classification of sleep stages from EEG data, with an emphasis on identifying sleep onset. In particular, we are interested in accurately distinguishing wakefulness from light (N1) sleep in both daytime and nighttime patterns. Current sleep staging methods are typically developed and validated within in-bed intervals, where performance is evaluated primarily on sleep epochs. Although these algorithms achieve high sensitivity for sleep detection, they typically demonstrate low specificity for wake epochs. This imbalance, compounded by the similarity in frequency content of EEG signals during relaxed wakefulness and N1 sleep and the pervasive presence of noise, can lead to a systematic underestimation of wake time. Moreover, many existing approaches require explicit prompting of wake and sleep intervals, which limits their generalizability. Our project seeks to overcome these limitations by developing an optimized, epoch-by-epoch classifier that operates on 30-second segments of EEG data. By doing so, we aim to extract robust features that are not only predictive of sleep stage transitions but may also serve as meaningful biomarkers for sleep onset and circadian regulation.

INITIAL PIPELINE
To address these challenges, we have constructed a modular pipeline using EEG data recorded from 29 subjects, each with approximately 93 channels stored in EDF files. Corresponding sleep stage labels are provided in text files, with one label per 30-second epoch. Our data loader (ANPDataLoader) extracts essential metadata—including sampling rates, channel labels, and recording duration—and segments each recording into 30-second epochs. Two feature extraction methods have been implemented. The first employs a traditional power spectral density (PSD) approach: the EEG signals are filtered using a Butterworth bandpass filter (0.5–40 Hz) and processed via Welch’s method to compute relative band power in the delta, theta, alpha, and beta bands. The second method utilizes the catch22 feature set, computed via the pycatch22 package, which efficiently produces 22 canonical time-series characteristics that capture aspects such as autocorrelation, entropy, and the distributional properties of the signal. 

CURRENT PROGRESS AND BOTTLENECKS
Our pipeline is currently capable of reading and segmenting EDF recordings, extracting features for each electrode on a per-30-second epoch basis, and aligning these feature vectors with the corresponding sleep stage labels. In preliminary tests, both the PSD-based and catch22-based feature extraction routines have been successfully executed on subsets of data (e.g., the first 10 minutes). However, significant bottlenecks persist. The sequential processing of each subject, epoch, and channel—especially with the catch22 computation. These limitations become even more acute when considering our long-term goal of processing full 24-hour recordings, which are necessary for developing classifiers that do not rely on manually specified in-bed intervals. Furthermore, the extended processing times hinder our ability to iterate quickly and optimize the feature extraction parameters.

SELF-CRITIQUE
While our engineered feature sets (PSD-based relative band power and catch22 features) provide an interpretable representation of EEG dynamics, they may not fully capture the subtle temporal nuances necessary to distinguish between relaxed wakefulness and light sleep. The current pipeline, although modular and conceptually robust, is constrained by its lack of parallelization and the computational expense of processing high-resolution EEG data across numerous epochs and electrodes. Parameter choices—such as the filter cutoff frequencies, epoch duration, and segmentation strategy—are fixed and may require further optimization to maximize both performance and generalizability. Additionally, while our engineered features have the advantage of interpretability, their efficacy in identifying biomarkers for sleep onset remains to be fully validated against more complex, data-driven approaches.

FUTURE WORK
Future work will focus on addressing the computational bottlenecks and exploring more advanced modeling techniques to improve sleep stage classification. We plan to implement parallel processing (using joblib or multiprocessing) to significantly reduce the runtime of our feature extraction routines, thereby enabling the processing of full 24-hour EEG recordings. With access to a 24-hour dataset (as used in studies such as Roberts et al., 2023), we aim to develop classifiers that do not require predefinition of in-bed intervals. On the modeling front, we intend to explore deep learning architectures—such as temporal convolutional networks (TCNs), convolutional neural networks (CNNs), and graph neural networks (GNNs)—which can automatically learn hierarchical representations from raw EEG signals, especially if the electrode coordinates are known. These models hold promise not only for improving classification performance but also for uncovering novel biomarkers that are indicative of sleep onset and circadian dynamics. By integrating these deep learning approaches with our engineered feature sets, we hope to bridge the gap between interpretability and predictive power, ultimately leading to robust and generalizable algorithms that improve state-of-the art sleep staging methods in biomedical and lifestyle settings alike.

SOURCES
https://osf.io/r26fh/ (dataset of 29 subjects)
https://time-series-features.gitbook.io/catch22/language-specific-docs/python (Catch22 Python documentation)
https://www.sciencedirect.com/science/article/pii/S2352721823001341?via%3Dihub (Actigraphy paper; using 24-hour segments; data access request pending)
https://link.springer.com/article/10.1007/s10618-019-00647-x (Catch22 paper)

